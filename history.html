<!DOCTYPE html>
<html lang="en">
    <!-- Google tag (gtag.js) -->
<script async src="https://www.googletagmanager.com/gtag/js?id=G-7KP0BL67YF"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'G-7KP0BL67YF');
</script>

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>The Grand Casita Theater - Screening History</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Cinzel:wght@400;700;900&family=Inter:wght@400;500&display=swap" rel="stylesheet">
    <style>
        body {
            font-family: 'Inter', sans-serif;
            background-color: #380000; /* Dark red background */
        }
        .font-cinzel {
            font-family: 'Cinzel', serif;
        }
        .text-shadow {
            text-shadow: 0 2px 4px rgba(0,0,0,0.6);
        }
        .text-brand-gold {
            color: #fde047; /* Tailwind's yellow-300 */
        }
        .timeline-container {
            max-width: 1000px;
            margin: 0 auto;
        }
        .timeline-wrapper {
            position: relative;
        }
        .timeline-wrapper::after {
            content: '';
            position: absolute;
            width: 6px;
            background-color: #fde047; /* Gold color for timeline */
            top: 0;
            bottom: 0;
            left: 50%;
            margin-left: -3px;
            z-index: 1;
        }
        .timeline-item {
            padding: 10px 40px;
            position: relative;
            background-color: inherit;
            width: 50%;
            z-index: 2;
        }
        .timeline-item::after {
            content: '';
            position: absolute;
            width: 25px;
            height: 25px;
            right: -17px;
            background-color: #380000;
            border: 4px solid #fde047;
            top: 30px;
            border-radius: 50%;
            z-index: 2;
        }
        .left {
            left: 0;
        }
        .right {
            left: 50%;
        }
        .left::before {
            content: " ";
            height: 0;
            position: absolute;
            top: 32px;
            width: 0;
            z-index: 2;
            right: 30px;
            border: medium solid #fde047;
            border-width: 10px 0 10px 10px;
            border-color: transparent transparent transparent #fde047;
        }
        .right::before {
            content: " ";
            height: 0;
            position: absolute;
            top: 32px;
            width: 0;
            z-index: 2;
            left: 30px;
            border: medium solid #fde047;
            border-width: 10px 10px 10px 0;
            border-color: transparent #fde047 transparent transparent;
        }
        .right::after {
            left: -16px;
        }
        @media screen and (max-width: 768px) {
            .timeline-wrapper::after {
                left: 31px;
            }
            .timeline-item {
                width: 100%;
                padding-left: 70px;
                padding-right: 25px;
            }
            .timeline-item::before {
                left: 60px;
                border: medium solid #fde047;
                border-width: 10px 10px 10px 0;
                border-color: transparent #fde047 transparent transparent;
            }
            .left::after, .right::after {
                left: 15px;
            }
            .right {
                left: 0%;
            }
        }
    </style>
</head>
<body class="text-white">

    <div class="container mx-auto p-8">
        <header class="text-center mb-16">
            <h1 class="text-5xl font-bold text-brand-gold font-cinzel text-shadow">Screening History</h1>
            <p class="text-lg text-yellow-300/70">A look back at the films and friends of The Grand Casita Theater.</p>
        </header>

        <div class="timeline-container">

            <!-- === DYNAMIC COMING SOON SECTION === -->
            <div class="text-center mb-20">
                <h2 class="text-3xl font-cinzel text-brand-gold text-shadow">Coming Soon</h2>
                <!-- This container will be populated by the script below -->
                <div id="comingSoonContainer" class="mt-4 flex flex-wrap justify-center gap-6">
                    <p class="text-gray-300">Loading upcoming movie nights...</p>
                </div>
            </div>
            <!-- === END DYNAMIC SECTION === -->


            <!-- Screening History Starts Here -->
            <div class="timeline-wrapper">

              
              <!-- Movie Entry -->
                <div class="timeline-item right">
                     <div class="bg-black/20 p-6 rounded-xl shadow-lg border border-yellow-300/20 hover:border-yellow-300/50 transition-all duration-300">
                         <img src="whatsupdoc.jpg" alt="What's Up Doc Poster" class="rounded-lg mb-4 shadow-md w-full" onerror="this.onerror=null;this.src='https://placehold.co/500x750/380000/fde047?text=Poster+Not+Found';">
                         <h3 class="text-2xl font-bold font-cinzel text-brand-gold">What's Up Doc?</h3>
                         <p class="text-sm text-yellow-300/70 italic mb-2">"A Screwball Comedy"</p>
                         <p class="font-semibold">September 4, 2025</p>
                         <p class="text-gray-300">Lane's Picks</p>
                     </div>
                </div>
                <!-- End Movie Entry -->
                
                <!-- Movie Entry -->
                <div class="timeline-item left">
                     <div class="bg-black/20 p-6 rounded-xl shadow-lg border border-yellow-300/20 hover:border-yellow-300/50 transition-all duration-300">
                         <img src="Beetlejuice2025-09-08_12-38-24.jpg" alt="Beetlejuice Poster" class="rounded-lg mb-4 shadow-md w-full" onerror="this.onerror=null;this.src='https://placehold.co/500x750/380000/fde047?text=Poster+Not+Found';">
                         <h3 class="text-2xl font-bold font-cinzel text-brand-gold">Beetlejuice</h3>
                         <p class="text-sm text-yellow-300/70 italic mb-2">"The ghost with the most"</p>
                         <p class="font-semibold">August 28, 2025</p>
                         <p class="text-gray-300">Lisa's Picks</p>
                     </div>
                </div>
                <!-- End Movie Entry -->
                
                <!-- Movie Entry -->
                <div class="timeline-item right">
                     <div class="bg-black/20 p-6 rounded-xl shadow-lg border border-yellow-300/20 hover:border-yellow-300/50 transition-all duration-300">
                         <img src="2025-08-21.jpg" alt="A Knight's Tale Poster" class="rounded-lg mb-4 shadow-md w-full" onerror="this.onerror=null;this.src='https://placehold.co/500x750/380000/fde047?text=Poster+Not+Found';">
                         <h3 class="text-2xl font-bold font-cinzel text-brand-gold">A Knight's Tale</h3>
                         <p class="text-sm text-yellow-300/70 italic mb-2">"He Will Rock You"</p>
                         <p class="font-semibold">August 21, 2025</p>
                         <p class="text-gray-300">Dustin's Picks</p>
                     </div>
                </div>
                <!-- End Movie Entry -->
                
                <!-- Movie Entry -->
                <div class="timeline-item left">
                     <div class="bg-black/20 p-6 rounded-xl shadow-lg border border-yellow-300/20 hover:border-yellow-300/50 transition-all duration-300">
                         <img src="2025-08-14.jpg" alt="Jaws Poster" class="rounded-lg mb-4 shadow-md w-full" onerror="this.onerror=null;this.src='https://placehold.co/500x750/380000/fde047?text=Poster+Not+Found';">
                         <h3 class="text-2xl font-bold font-cinzel text-brand-gold">Jaws</h3>
                         <p class="text-sm text-yellow-300/70 italic mb-2">"You'll never go in the water again"</p>
                         <p class="font-semibold">August 14, 2025</p>
                         <p class="text-gray-300">Stacy's Picks</p>
                     </div>
                </div>
                <!-- End Movie Entry -->

            </div> <!-- End Timeline Wrapper -->
        </div>
    </div>

    <!-- === Return to Main Page Button === -->
    <a href="index.html" class="fixed bottom-4 left-4 text-sm font-cinzel text-yellow-300/50 hover:text-brand-gold transition-colors flex items-center gap-2">
        <svg xmlns="http://www.w3.org/2000/svg" class="h-4 w-4" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="2">
            <path stroke-linecap="round" stroke-linejoin="round" d="M10 19l-7-7m0 0l7-7m-7 7h18" />
        </svg>
        Return to Main Page
    </a>
    <!-- === END BUTTON === -->

    <script>
        // --- Script to fetch and display "Coming Soon" data ---

        // IMPORTANT: Replace this with the same Google Apps Script Web App URL you used for the signup form.
        const webAppUrl = 'https://script.google.com/macros/s/AKfycbwZwm7Zrwth0MzF2TXTVfKsPVmpbninp4yzWY_N7NH4P-4nfr-8foMrHeruGb-Wm5uOxw/exec';
        
        document.addEventListener('DOMContentLoaded', () => {
            const container = document.getElementById('comingSoonContainer');

            fetch(webAppUrl)
                .then(response => {
                    if (!response.ok) {
                        throw new Error('Network response was not ok');
                    }
                    return response.json();
                })
                .then(data => {
                    // Clear the loading message
                    container.innerHTML = ''; 

                    // Check if there's any data returned
                    if (data && data.length > 0) {
                        data.forEach(signup => {
                            // Get the relevant data from each signup object
                            const movieTitle = signup.MovieTitle;
                            const pickedBy = signup.Name;
                            const confirmedDate = signup.confDate;
                            const moviePosterFile = signup.moviePoster; // Get the poster filename
                            const trailerUrl = signup.Trailer; // Get the trailer URL

                            let dateBannerHtml = '';

                            // Check if a confirmed date is available in the sheet
                            if (confirmedDate) {
                                const date = new Date(confirmedDate);
                                
                                if (!isNaN(date.getTime())) {
                                    const options = { weekday: 'short', year: 'numeric', month: 'short', day: 'numeric', timeZone: 'UTC' };
                                    const formattedDate = date.toLocaleDateString('en-US', options);

                                    // Create a green banner for confirmed dates
                                    dateBannerHtml = `
                                        <div class="absolute top-0 left-0 bg-green-600 text-white text-xs font-bold px-2 py-1 rounded-br-lg rounded-tl-lg z-10">
                                            ${formattedDate}
                                        </div>
                                    `;
                                } else {
                                     // If the date is invalid after parsing, show the unconfirmed banner
                                    dateBannerHtml = `
                                        <div class="absolute top-0 left-0 bg-red-600 text-white text-xs font-bold px-2 py-1 rounded-br-lg rounded-tl-lg z-10">
                                            DATE NOT CONFIRMED
                                        </div>
                                    `;
                                }
                            } else {
                                // Create a red banner if the date is not confirmed
                                dateBannerHtml = `
                                    <div class="absolute top-0 left-0 bg-red-600 text-white text-xs font-bold px-2 py-1 rounded-br-lg rounded-tl-lg z-10">
                                        DATE NOT CONFIRMED
                                    </div>
                                `;
                            }

                            let cardHtml = '';

                            // Create a different card depending on whether a movie title was provided
                            if (movieTitle) {
                                // --- UPDATED LOGIC FOR POSTER AND TRAILER ---
                                const posterBaseUrl = 'https://thegrandcasitatheater.com/';
                                const posterSrc = moviePosterFile 
                                    ? posterBaseUrl + moviePosterFile 
                                    : `https://placehold.co/200x300/380000/fde047?text=${encodeURIComponent(movieTitle)}`;

                                const imageElement = `<img src="${posterSrc}" alt="${movieTitle} Poster" class="rounded-lg shadow-md h-48 object-cover ${trailerUrl ? 'cursor-pointer hover:opacity-80 transition-opacity' : ''}" onerror="this.onerror=null;this.src='https://placehold.co/200x300/380000/fde047?text=Poster+Not+Found';">`;
                                
                                const finalImageHtml = trailerUrl 
                                    ? `<a href="${trailerUrl}" target="_blank" rel="noopener noreferrer">${imageElement}</a>`
                                    : imageElement;

                                // Card for when a movie HAS been chosen
                                cardHtml = `
                                    <div class="relative bg-black/20 pt-8 p-4 rounded-xl shadow-lg border-2 border-yellow-300/30 flex flex-col items-center text-center w-64">
                                        ${dateBannerHtml}
                                        ${finalImageHtml}
                                        <h4 class="font-bold text-lg text-brand-gold mt-3">${movieTitle}</h4>
                                        <p class="text-gray-300">Picked by: ${pickedBy}</p>
                                    </div>
                                `;
                            } else {
                                // Card for when a movie has NOT YET been chosen
                                cardHtml = `
                                    <div class="relative bg-black/20 pt-8 p-4 rounded-xl shadow-lg border-2 border-yellow-300/30 flex flex-col items-center text-center w-64">
                                        ${dateBannerHtml}
                                        <img src="https://placehold.co/200x300/380000/fde047?text=Coming%0AAttractions" alt="Coming Attractions" class="rounded-lg shadow-md h-48 object-cover">
                                        <h4 class="font-bold text-lg text-brand-gold mt-3">Selection Pending</h4>
                                        <p class="text-gray-300">Picked by: ${pickedBy}</p>
                                    </div>
                                `;
                            }
                            // Add the newly created card to the container
                            container.innerHTML += cardHtml;
                        });
                    } else {
                        // Display a message if no signups are found
                        container.innerHTML = '<p class="text-gray-400">No upcoming movie nights have been scheduled yet.</p>';
                    }
                })
                .catch(error => {
                    console.error('Error fetching coming soon data:', error);
                    container.innerHTML = '<p class="text-red-400">Could not load upcoming movie nights. Please try again later.</p>';
                });
        });
    </script>

</body>
</html>
